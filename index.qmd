---
title: "Analyzing ACS Data with Visualizations"
author: "Adriana Vance and Elena Koshkin"
format: html
editor: visual
https://catalog.data.gov/dataset/crash-reporting-drivers-data 
---

```{r}
Crash <- read.csv("Crash.csv")

library(ggplot2)
library(dplyr)
library(tigris)

```

## Visualization 1

```{r}
Crash %>%
  group_by(Collision.Type) %>%
  summarize(count = n()) %>%
  filter(count > 10000) %>%
  filter(Collision.Type != "OTHER") %>%
  ggplot() + 
  geom_col(mapping = aes(y = count, x = Collision.Type, color = Collision.Type)) + 
  theme(axis.text.x = element_blank()) + 
  labs(
    x = "Collision Type",
    y = "Total Collisions"
  ) 
```

## Visualization 2

```{r}
library(sf)
sf_data <- st_as_sf(Crash, coords = c("Longitude", "Latitude"), crs = 4326)

# Get the county boundaries for the entire state of Maryland
maryland_counties <- counties("MD")
# Filter Montgomery County
montgomery_county <- maryland_counties[maryland_counties$NAME == "Montgomery", ]

montgomery_roads <- roads("MD", "Montgomery")

filtered_crash_data <- sf_data %>%
  group_by(ACRS.Report.Type) %>%
  filter(ACRS.Report.Type == "Fatal Crash") %>%
  summarize(count = n())

montgomery_roads %>%
  ggplot() + 
   geom_sf(data = montgomery_county) +
    geom_sf(data = montgomery_roads) +
  geom_sf(data = filtered_crash_data, aes(color = "Location of Crashes")) + 
  labs(
    title = "Fatal Crashes 2015-2023") + 
  theme_void() + 
  scale_color_manual(
    name = "",
    values = c("Location of Crashes" = "red")
  )

```

## Visualization 3

```{r}
ggplot(Crash, aes(x=Speed.Limit)) + 
 geom_histogram(aes(y=after_stat(density)), colour="black", fill="white")+
 geom_density(alpha=.2, fill="#FF6666") 
# Color by groups
ggplot(Crash, aes(x=Speed.Limit, color=Driver.At.Fault, fill=Driver.At.Fault)) + 
 geom_histogram(aes(y=after_stat(density)), alpha=0.5, 
                position="identity")+
 geom_density(alpha=.2) 
  

```

## Visualization 4

```{r}

Crash %>%
  filter(Vehicle.Year > 1940 & Vehicle.Year < 2023) %>%
  filter(Injury.Severity == "FATAL INJURY") %>% 
  ggplot() +
  geom_dotplot(mapping = aes(x = Vehicle.Year, y = Injury.Severity, color = Injury.Severity))

```
